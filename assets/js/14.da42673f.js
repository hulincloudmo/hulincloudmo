(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{322:function(n,t,s){"use strict";s.r(t);var a=s(0),e=Object(a.a)({},(function(){var n=this,t=n.$createElement,s=n._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("h1",{attrs:{id:"微信小程序编写一个高面向对象的规格选择-spu-组件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#微信小程序编写一个高面向对象的规格选择-spu-组件","aria-hidden":"true"}},[n._v("#")]),n._v(" 微信小程序编写一个高面向对象的规格选择(SPU)组件")]),n._v(" "),s("h2",{attrs:{id:"开场白"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开场白","aria-hidden":"true"}},[n._v("#")]),n._v(" 开场白")]),n._v(" "),s("p",[n._v("本文开始将介绍如何使用微信小程序实现一个完美的，面向对象的SPU组件，因为代码较多，最后将会提供github源码链接供大家参考！")]),n._v(" "),s("p",[n._v("效果图"),s("a",{attrs:{href:"/spu-preview.jpg"}},[n._v("!Image")])]),n._v(" "),s("h2",{attrs:{id:"服务器数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#服务器数据","aria-hidden":"true"}},[n._v("#")]),n._v(" 服务器数据")]),n._v(" "),s("p",[n._v("我们首先先看看服务器所返回的数据结构")]),n._v(" "),s("pre",[s("code",[n._v(' {\n    "id":2,\n    "title":"林间有风自营针织衫",\n    "subtitle":"瓜瓜设计，3件包邮",\n    "category_id":12,\n    "root_category_id":2,\n    "price":"77.00",\n    "img":"",\n    "for_theme_img":"",\n    "description":null,\n    "discount_price":"62.00",\n    "tags":"包邮$热门",\n    "is_test":true,\n    "online":true,\n    "sku_list":[\n        {\n            "id":2,\n            "price":77.76,\n            "discount_price":null,\n            "online":true,\n            "img":"",\n            "title":"金属灰·七龙珠",\n            "spu_id":2,\n            "category_id":17,\n            "root_category_id":3,\n            "specs":[\n                {\n                    "key_id":1,\n                    "key":"颜色",\n                    "value_id":45,\n                    "value":"金属灰"\n                },\n                {\n                    "key_id":3,\n                    "key":"图案",\n                    "value_id":9,\n                    "value":"七龙珠"\n                },\n                {\n                    "key_id":4,\n                    "key":"尺码",\n                    "value_id":14,\n                    "value":"小号 S"\n                }\n            ],\n            "code":"2$1-45#3-9#4-14",\n            "stock":5\n        },\n        {\n            "id":3,\n            "price":66,\n            "discount_price":59,\n            "online":true,\n            "img":"",\n            "title":"青芒色·灌篮高手",\n            "spu_id":2,\n            "category_id":17,\n            "root_category_id":3,\n            "specs":[\n                {\n                    "key_id":1,\n                    "key":"颜色",\n                    "value_id":42,\n                    "value":"青芒色"\n                },\n                {\n                    "key_id":3,\n                    "key":"图案",\n                    "value_id":10,\n                    "value":"灌篮高手"\n                },\n                {\n                    "key_id":4,\n                    "key":"尺码",\n                    "value_id":15,\n                    "value":"中号 M"\n                }\n            ],\n            "code":"2$1-42#3-10#4-15",\n            "stock":999\n        },\n        {\n            "id":4,\n            "price":88,\n            "discount_price":null,\n            "online":true,\n            "img":"",\n            "title":"青芒色·圣斗士",\n            "spu_id":2,\n            "category_id":17,\n            "root_category_id":3,\n            "specs":[\n                {\n                    "key_id":1,\n                    "key":"颜色",\n                    "value_id":42,\n                    "value":"青芒色"\n                },\n                {\n                    "key_id":3,\n                    "key":"图案",\n                    "value_id":11,\n                    "value":"圣斗士"\n                },\n                {\n                    "key_id":4,\n                    "key":"尺码",\n                    "value_id":16,\n                    "value":"大号  L"\n                }\n            ],\n            "code":"2$1-42#3-11#4-16",\n            "stock":8\n        },\n        {\n            "id":5,\n            "price":77,\n            "discount_price":59,\n            "online":true,\n            "img":"http://i1.sleeve.7yue.pro/assets/09f32ac8-1af4-4424-b221-44b10bd0986e.png",\n            "title":"橘黄色·七龙珠",\n            "spu_id":2,\n            "category_id":17,\n            "root_category_id":3,\n            "specs":[\n                {\n                    "key_id":1,\n                    "key":"颜色",\n                    "value_id":44,\n                    "value":"橘黄色"\n                },\n                {\n                    "key_id":3,\n                    "key":"图案",\n                    "value_id":9,\n                    "value":"七龙珠"\n                },\n                {\n                    "key_id":4,\n                    "key":"尺码",\n                    "value_id":14,\n                    "value":"小号 S"\n                }\n            ],\n            "code":"2$1-44#3-9#4-14",\n            "stock":7\n        }\n    ],\n    "spu_img_list":[\n        {\n            "id":165,\n            "img":"http://i1.sleeve.7yue.pro/assets/5605cd6c-f869-46db-afe6-755b61a0122a.png",\n            "spu_id":2\n        }\n    ],\n    "spu_detail_img_list":[\n        {\n            "id":24,\n            "img":"http://i2.sleeve.7yue.pro/n4.png",\n            "spu_id":2,\n            "index":1\n        }\n    ],\n    "sketch_spec_id":1,\n    "default_sku_id":2\n}\n')])]),n._v(" "),s("h3",{attrs:{id:"服务器返回数据分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#服务器返回数据分析","aria-hidden":"true"}},[n._v("#")]),n._v(" 服务器返回数据分析")]),n._v(" "),s("p",[n._v("上面长长的一串数据就是一个商品页面的返回结果，我们先看spces(属性)，在sku_list中的specs中记录了每个SPU对应的sku规格值，从数据中我们可以看出，每个spu拥有3个规格值分别是颜色，图案，尺码，我们将每个SPU数据单独抽离出来可以得到：")]),n._v(" "),s("pre",[s("code",[n._v("金属灰 七龙珠 小号 S\n青芒色 灌篮高手 中号 M\n青芒色 圣斗士 大号 L\n橘黄色 七龙珠 小号 S\n")])]),n._v(" "),s("p",[n._v("对比效果图"),s("a",{attrs:{href:"/spu-preview.jpg"}},[n._v("!Image")]),n._v("\n我们可以发现，这两玩意好像啊，不就是每一行读下来并且去重就是渲染所需要的数据了么？那么接下来，我们就想办法将数据换一换。")]),n._v(" "),s("h3",{attrs:{id:"通过矩阵思想解决问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通过矩阵思想解决问题","aria-hidden":"true"}},[n._v("#")]),n._v(" 通过矩阵思想解决问题")]),n._v(" "),s("p",[n._v("在大学的课程中我们学过矩阵，那么这样的变化不就是"),s("strong",[n._v("矩阵的转置")]),n._v("么？把每一列变成行，就可以初步得到我们想要的数据渲染数组！")]),n._v(" "),s("pre",[s("code",[n._v("金属灰 青芒色 青芒色 橘黄色\n七龙珠 灌篮高手 圣斗士 七龙珠\n小号 中号 大号 小号\n")])]),n._v(" "),s("p",[n._v("However,很遗憾，js中并没有提供矩阵的转置函数，所以，我们得自己实现矩阵的转置")]),n._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[n._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[n._v("// 矩阵处理类")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("class")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[n._v("Matrix")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n    matrix\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("constructor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[n._v("matrix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("matrix "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" matrix\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("get")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("rowsNum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("return")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("matrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("length\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("get")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("colsNum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("return")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("matrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("length\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("transpose")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("const")]),n._v(" desArr "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("for")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("let")]),n._v(" j "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v(" j "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("colsNum"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v(" j"),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n            desArr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("j"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("for")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("let")]),n._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("<")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("rowsNum"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n                desArr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("j"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(".")]),n._v("matrix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v("j"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("return")]),n._v(" desArr\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("export")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n    Matrix\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n\n")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);